{{ block style }}
<style>
.otree-body {
    max-width:85%;
    margin: 0 auto
}
body {
  font-family: Arial, sans-serif;
  font-size: 16px;
}
.btn-container {
			display: flex;
			justify-content: center;
			align-items: center;
			padding-top: 20px;
		}

/* Style the title block */
h1 {
  font-size: 24px;
  margin-top: 0;
  border: 1px solid #ccc;
  padding: 10px;
}

p {
  margin-bottom: 10px;
}

/* Style the main container */
.main-container {
  display: flex;
  justify-content: center;
  margin-bottom: 20px;
}

/* Style the text box */
.text-box {
  width: 100%;
  border: 1px solid #ccc;
  padding: 10px;
}

/* Style the sub container */
.sub-container {
  display: flex;
  justify-content: center;
  margin-bottom: 20px;
}

/* Style the calculator box */
.calculator-box {
  width: 100%;
  border: 1px solid #ccc;
  padding: 10px;
}

/* Style the table box */
.table-box {
  flex-basis: 60%;
  border: 1px solid #ccc;
  padding: 10px;
}

/* Style the table title */
.table-box h2 {
  margin-top: 0;
  font-size: 20px;
}

/* Style the table */
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 10px;
}

th,
td {
  padding: 8px;
  text-align: center;
  border-bottom: 1px solid #ddd;
}

th {
  background-color: #f2f2f2;
  text-align: center;
  border-bottom: 1px solid #ddd
}

/* Style the "No data available" message */
p.no-data {
  font-style: italic;
  color:}

</style>
{{ endblock }}

{{ block scripts}}
<script>
var sliderA = document.getElementById("sliderRangeA");
var sliderB = document.getElementById("sliderRangeB");
var outputA = document.getElementById("sliderFirmA");
var outputB = document.getElementById("sliderFirmB");

b1="";
b2="";
ProfitA=0;
let firmAChoice=0;
let firmBChoice=0;

let prohPrice=100;
bonus_fixed=100
//prohibitive price
let CONTRACT_TYPE_RP = false
let gamma=1;
let message='Your firm is not making profits, your total payment is 0. ';

if (CONTRACT_TYPE_RP) {
  message_for_instructions='Your total compensation for this round is TOTAL COMP = (Your profit) + 100 + (Your profit - Profit of other firm)';
} else {
  message_for_instructions='Your total compensation for this round is TOTAL COMP = (Your profit) + 100';
}
message_instructions.innerHTML=message_for_instructions;


sliderA.oninput = function() {
outputA.innerHTML = this.value; // display value A in HTML
firmAChoice=this.value*1; // value A in slider
};
sliderB.oninput = function() {
outputB.innerHTML = this.value; // display value B in HTML
firmBChoice=this.value*1;// value B in slider

};

[sliderA,sliderB].forEach(function(element) {
	element.addEventListener("input", function() {
  	if (firmAChoice+firmBChoice<prohPrice){
        profitA=(prohPrice-firmAChoice-firmBChoice)*firmAChoice;
        profitB=(prohPrice-firmAChoice-firmBChoice)*firmBChoice;
        if(CONTRACT_TYPE_RP){
          firmBBonus=bonus_fixed+gamma*(profitB-profitA);
          total_compensation=profitB+firmBBonus;
          message='Your firm`s profits are ' + profitB + '. Your bonus is ' + firmBBonus + '. Your total compensation is ' + total_compensation + '.';
          if (total_compensation<0){
            total_compensation = 0;
            message = 'Your bonus is negative and exceeds the profits. Your total compensation is 0.'};
        } else {
          firmBBonus=bonus_fixed
          total_compensation=profitB+firmBBonus;
          message='Your firm`s profits are ' + profitB + '. Your bonus is ' + firmBBonus + '. Your total compensation is ' + total_compensation + '.';
          if (total_compensation<0){
            total_compensation = 0;
            message = 'Your bonus is negative and exceeds the profits. Your total compensation is 0.'};
        }
        if (firmBChoice==0){
          firmBBonus=0;
          total_compensation=profitB+firmBBonus;
          message='Your firm is not producing any quantity, your total compensation is 0.';
      }
    } else {
    profitA=0;
    profitB=0;
    firmBBonus=0;

    message='Total production is at the maximum of 100. Your total compensation is 0. ';
    }
	firmAProfit.innerHTML=profitA.toFixed(0);
    firmBProfit.innerHTML=profitB.toFixed(0);
    my_bonusFirmB.innerHTML=firmBBonus.toFixed(0);
    my_total_compensation.innerHTML=total_compensation.toFixed(0);
    messageContract.innerHTML=message;
  });
});


  function calculateProfits(myOutput, otherOutput) {
    // Placeholder formulas - modify as needed
    const myProfit = myOutput * (100 - myOutput - otherOutput);
    const otherProfit = otherOutput * (100 - myOutput - otherOutput);
    return [myProfit, otherProfit];
  }

  function calculateCompensation(myOutput, myProfit) {
    // Placeholder formula - modify as needed
    return myProfit+100;
  }

  document.getElementById('chooseBtn').addEventListener('click', function() {
     event.preventDefault();
    const userChoice = document.getElementById('userChoice').value;
    const userChoiceOther = document.getElementById('userChoiceOther').value;
     if (userChoice === "" || userChoice < 0 || userChoice > 50 || userChoiceOther === "" || userChoiceOther < 0 || userChoiceOther > 50) {
        alert('Please enter a valid number between 0 and 50');
        return;
      }

      let otherFirmOutput;

      const [myProfit, otherProfit] = calculateProfits(userChoice, userChoiceOther);
      const myCompensation = calculateCompensation(userChoice, myProfit);

      const newRow = document.createElement('tr');
      newRow.innerHTML = `
        <td>${userChoice}</td>
        <td>${userChoiceOther}</td>
        <td>${myProfit.toFixed(2)}</td>
        <td>${otherProfit.toFixed(2)}</td>
        <td>${myCompensation.toFixed(2)}</td>
      `;
      document.getElementById('results').appendChild(newRow);
    });


</script>
{{ endblock }}




{{ block title }}
    <h1>Information about setting, matching and compensation </h1>
{{ endblock }}

{{ block content }}
<div class="table-box">
    <h3 style="font-size: 20px;"><b> Main part of the experiment </b></h3>
    In the main part of the experiment, you will be playing as a manager in 4 markets. Each market will last for several periods.
    <br>
    In each market you will be matched with a different participant. You will be given information about your contract, contract of the participant you are matched with, a calculator similar to the one on the previous page and details about the outcomes in the previous periods.

    <h3 style="font-size: 20px;"><b> Duration of the markets </b></h3>
    The markets will last for an unknown number of periods. For each period the computer have generated a random number between 1 to 10. If a number for a period is 10, the market stops and you will be rematched with another participant.
    You will be notified about this by a respective page. In other words, the probability that the market will stop is 10%.
    <br>
    The past history table (which you can see on the bottom right) will show you history in the current market (i.e. with the same participant. After you are rematched, the table would restart.
    <br>
    <h3 style="font-size: 20px;"><b> Your compensation </b></h3>
    After you have played four markets in the main part of the experiment, we will draw a random number between 1-4 and pay you the average compensation you have earned in that market. In addition, you will also receive your participant fee.
    <h3 style="font-size: 20px;"><b> Example </b></h3>
    Below you can see an example market where you would play with a computerised manager.
    <span id="message_instructions"></span>
</div>


<div class="sub-container">
  <div class="calculator-box">
<meta name="viewport" content="width=device-width, initial-scale=2">
<style>
.responsive {
    width: auto;
    height: auto;
  }

  .slidecontainer {
    margin-left: 1%;
    margin-right: 1%;
    width: 98%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
  }

  .center {
    margin-left: 10%;
  }
  .slidertable { /*This is a table for slider and ticks */
     table-layout: fixed;
      width: 100%;
      max-width: 900px;
  }

  .infotable {
   border: 2px solid black;
    table-layout: fixed;
    width: 100%;
    padding: 10px;
    border-spacing: 5px;
  }
  .slides::-webkit-scrollbar {
    width: 5px;
    height: 5px;
  }

  .slides::-webkit-scrollbar-thumb {
    background: black;
    border-radius: 5px;
  }

  .slides::-webkit-scrollbar-track {
    background: transparent;
  }
input[type=range]::-webkit-slider-thumb {
  -webkit-appearance: none;
  border: 1px solid #000000;
  height: 25px;
  width: 13px;
  border-radius: 3px;
  background: #ff0000;
  cursor: pointer;
  margin-top: -5px; /* You need to specify a margin in Chrome, but in Firefox and IE it is automatic */
  box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d; /* Add cool effects to your sliders! */
}

/* All the same stuff for Firefox */
input[type=range]::-moz-range-thumb {
  box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
  border: 1px solid #000000;
  height: 25px;
  width: 13px;
  border-radius: 3px;
  background: #ff0000;
  cursor: pointer;
}

/* All the same stuff for IE */
input[type=range]::-ms-thumb {
  box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
  border: 1px solid #000000;
  height: 25px;
  width: 13px;
  border-radius: 3px;
  background: #ff0000;
  cursor: pointer;
}

  .slider {
    -webkit-appearance: none;
    width: 99%;
    /* <-- Problem was here when width is 100% */
    height: 15px;
    background: #d3d3d3;
    outline: none;
    opacity: 0.7;
    -webkit-transition: .2s;
    transition: opacity .2s;
  }

  .sliderticks {
    display: flex;
    justify-content: space-between;
    padding: 0 10px;
  }

  .sliderticks p {
    position: relative;
    display: flex;
    justify-content: center;
    text-align: center;
    width: 2px;
    background: #D3D3D3;
    height: 10px;
    line-height: 40px;
    margin: 0 0 20 0;
  }

</style>


<div class="slidecontainer">
  <h3 style="font-size: 20px;"><b> Firms' Profit Calculator </b></h3>
  <table class="slidertable">
    <tbody>
      <tr>
        <td style="text-align:center;">
          <h3 style="text-align: center;font-size: 18px;"><span style="color: inherit; font-family: inherit; background-color: initial;">If the other participant chooses: <span id="sliderFirmA"></span><br></span></h3>
        </td>
      </tr>
      <tr>
        <td>
          <input type="range" min="0" max="50" value="0" class="slider" id="sliderRangeA" step="1"></td>
      </tr>
      <tr>
        <td>
          <div class="sliderticks">
             <p>0</p>
            <p>10</p>
            <p>20</p>
            <p>30</p>
            <p>40</p>
            <p>50</p>
          </div>
        </td>
      </tr>

    </tbody>
  </table>
  <table class="slidertable" style="margin-top:15px;">
    <tbody>
      <tr>
        <td style="text-align:center;">
          <h3 style="text-align: center;font-size: 18px;"><span style="color: inherit; font-family: inherit; background-color: initial;">And you choose: <span id="sliderFirmB"></span><br></span></h3>
        </td>
      </tr>
      <tr>
        <td>
          <input type="range" min="0" max="50" value="0" class="slider" id="sliderRangeB" step="1"></td>
      </tr>
      <tr>
        <td>
          <div class="sliderticks">
               <p>0</p>
            <p>10</p>
            <p>20</p>
            <p>30</p>
            <p>40</p>
            <p>50</p>
          </div>
        </td>
      </tr>

    </tbody>
  </table>

<br>
  <h3 style="font-size: 16px;"><b> Firms' profits and your compensation</b></h3>

  <table class="infotable" style="text-align: center; margin-top: 10px; border-collapse: collapse;">

    <colgroup>
      <col style="width:25%; border: 1px solid black;">
      <col style="width:25%; border: 1px solid black;">
      <col style="width:15%; border: 1px solid black;">
      <col style="width:30%; border: 1px solid black;">
    </colgroup>

    <tbody>

      <tr>
        <td><b>Other firm's profits</b></td>
        <td><b>My firm's profits</b></td>
        <td><b>My bonus</b></td>
        <td><b>My compensation</b></td>
      </tr>

      <tr>
        <td><b><span id="firmAProfit"></span></b></td>
        <td><b><span id="firmBProfit"></span></b></td>
        <td><b><span id="my_bonusFirmB"></span></b></td>
        <td><b><span id="my_total_compensation"></span></b></td>
      </tr>
    </tbody>

  </table>
    <table class="infotable" style="text-align: center; margin-top: 10px;">
      <tbody>
        <tr>
          <td style="text-align: center;"> &nbsp; <b> <span id="messageContract"></span></b> </td>
        </tr>

      </tbody>
    </table>

</div>

  </div>

  <div class="table-box">
    <b><label for="userChoice">Your quantity choice:</label> </b>
    <input type="number" id="userChoice" min="0" max="50">
    <br>
    <b><label for="userChoiceOther">Quantity choice for the other firm:</label> </b>
    <input type="number" id="userChoiceOther" min="0" max="50">
    <br>
    <button id="chooseBtn">Choose</button>
    <br>
    <br>
    <h3 style="font-size: 20px;"><b> Past History </b></h3>
    <table>
    <thead>
      <tr>
        <th>My output</th>
        <th>Other firm's output</th>
        <th>My firm's profit</th>
        <th>Other firm's profit</th>
        <th>My compensation</th>
      </tr>
    </thead>
    <tbody id="results">
    </tbody>
  </table>
  </div>
</div>

<div class="btn-container">
  {{ next_button }}
</div>




{{ endblock }}
